---
title: "Sumi focus perception results"
output: html_document
---

## 1. Load Data
```{r}
library(Rmisc)
library(ggplot2)
library(dplyr)

#rm(list=ls())
SumiFoc.df <- read.csv("data/results.csv", header = TRUE, sep = ",")

# Convert from wide to long format
#library(tidyr)
#SumiFoc.long <- gather(SumiFoc.df, key = "Listener", value = "Score", L01:L12)
#View(SumiFoc.wide)
#SumiFoc.long$Listener <- as.factor(SumiFoc.long$Listener)
#str(SumiFoc.long)

SumiFoc.df$factor <- paste(SumiFoc.df$predicate_gloss, SumiFoc.df$condition, sep = "_")
SumiFoc.df$factor <- factor(SumiFoc.df$factor, levels = c("chasing_broad","chasing_narrow","sleeping_broad","sleeping_narrow","bigger_narrow"))
SumiFoc.df$score <- SumiFoc.df$key_resp_5.keys
SumiFoc.df$score <- gsub("w", 1, SumiFoc.df$score)
SumiFoc.df$score <- gsub("f", 2, SumiFoc.df$score)
SumiFoc.df$score <- gsub("j", 3, SumiFoc.df$score)
SumiFoc.df$score <- gsub("p", 4, SumiFoc.df$score)
SumiFoc.df$score <- as.integer(SumiFoc.df$score)

# Group all tone tokens into tone types
SumiFoc.df$AS_tone <- gsub(".{1}$", "", SumiFoc.df$AS_tone)

# Omit participants 5 & 8
#SumiFoc.df <- subset(SumiFoc.df, participant != "5")
#SumiFoc.df <- subset(SumiFoc.df, participant != "8")
```


## 2. Look at effect of Condition (Carrier1 vs. Isol1 vs. Isol3) on Score
```{r}
# Count number of each rating, by factor
count(SumiFoc.df, factor, score)

# Summarize by and Condition & Listener
SumiFoc.summ <- summarySE(SumiFoc.df, "score", groupvars = c("predicate_gloss", "condition"), na.rm = TRUE)
SumiFoc.summ
SumiFoc.summ$factor <- paste(SumiFoc.summ$predicate_gloss, SumiFoc.summ$condition, sep = "_")
SumiFoc.summ$factor <- factor(SumiFoc.summ$factor, levels = c("chasing_broad","chasing_narrow","sleeping_broad","sleeping_narrow","bigger_narrow"))
#SumiFoc.summ$factor <- interaction(SumiFoc.summ$predicate_gloss, SumiFoc.summ$condition)

# Boxplot
SumiFoc.plot <- ggplot(SumiFoc.df, aes(x=factor, y=score)) + 
  geom_boxplot() +
  theme_bw() +
  labs(x = "Clause type & Focus condition", y = "Interpretation\n1 = Narrow Focus, 4 = Broad Focus") +
  scale_x_discrete(labels = c("transitive\n(broad)","transitive\n(narrow)", "intransitive\n(broad)", "intransitive\n(narrow)", "verbless\n(narrow)")) +
  theme(axis.title = element_text(size=20),
           axis.text  = element_text(size=16)) +
  coord_flip()
SumiFoc.plot

dev.copy(png, "figures/SumiFoc-perception_score-8subjects.png")
dev.off()

#SumiFoc.subset <- subset(SumiFoc.df, predicate_gloss != "bigger")
#boxplot(score ~ AS_tone, data = SumiFoc.subset, main = "Score by Tone", ylab = "Tone", xlab = "1 = Narrow Focus, 4 = Broad Focus", ylim=c(0,5), horizontal = T)
```

## Save RData
```{r}
save.image(file="output/SumiFoc-perception.RData")
```